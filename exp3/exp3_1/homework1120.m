clc;
clear all;

x=[0.63853 0.033604 0.068806
0.3196 0.53086 0.65445
0.40762 0.81998 0.71836
0.96865 0.53133 0.32515
0.10563 0.61096 0.7788
0.42345 0.090823 0.26647
0.15366 0.28101 0.44009
0.52714 0.45742 0.87537
0.51805 0.94362 0.63771
0.95769 0.24071 0.67612
0.28906 0.67181 0.69514
0.067993 0.25479 0.22404]

y=[0.014557774930175571 0.6171993859981115 0.991556488360658
0.5317712339495152 0.3324402973665267 0.4055861234895181
0.8142658932850055 0.4397242285706564 0.3414822351710044
0.4887557719476766 0.9800685911904863 0.7348760811630132
0.6260142967745475 0.12434190228902697 0.28118597697209813
0.08599785857269726 0.4064484720388021 0.7938576164718256
0.29380392550470247 0.15006637875792062 0.6201149785220865
0.44437688179355705 0.5345511158527314 0.1847120058578905
0.9302431292478377 0.5582335568561066 0.42204821340837306
0.19930046034388607 0.9495440057031354 0.3840999143397348
0.6744306864689601 0.3114578573465352 0.3648026951232214
0.27355508718144006 0.06284120802996007 0.836183671120577]

[m,n]=size(x)
A = zeros(m*3,9);
B = zeros(m*3,1);

[U1,S1,V1]=svds(x)
[U2,S2,V2]=svds(y)

for i=1:12;
    A(3*i-2,1:3)=U1(i,:);
    A(3*i-1,4:6)=U1(i,:);
    A(3*i,7:9)=U1(i,:);
    B(3*i-2:3*i)=U2(i,:);
end

r=A\B;
R=zeros(3);
for i=1:3;
    for j=1:3;
        R(i,j)=r(i+j);
    end
end

